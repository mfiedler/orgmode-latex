#+TITLE: Example for Org Mode export to LaTeX
#+DATE:
#+AUTHOR: Michael Fiedler
# INCLUDE: include.org
#+OPTIONS: toc:nil ^:nil num:3
#+LANGUAGE: en
#+LATEX_CLASS: article
#+LATEX_CLASS_OPTIONS: [a4paper,10pt,oneside,twocolumn]
#+LATEX_HEADER: \usepackage{lipsum}    % insert Lorem ipsum texts
#+LATEX_HEADER: \usepackage{times}     % use Times font
#+LATEX_HEADER: \usepackage{svg}
#+LATEX_HEADER: \usepackage{titling}   % fine-tuning of \maketitle
# LATEX_HEADER: \usepackage{flushend}  % columns of last page equal in size; messes up bibliography if used!
#+LATEX_HEADER: %\usepackage{cite}      % various improvements for \cite; incompatible with biblatex
#+LATEX_HEADER: \usepackage{breakurl}           % break too-long urls in refs
#+LATEX_HEADER: \usepackage{url}                % allow \url in bibtex for clickable links
#+LATEX_HEADER: %\usepackage{xurl}      % allow line break anywhere in URL to avoid weird-looking space
#+LATEX_HEADER: \usepackage{xcolor}    % color definitions, to be used for \hypersetup and \lstset
#+LATEX_HEADER: \usepackage{hyperref}  % clickable references within PDF
#+LATEX_HEADER: \usepackage{filecontents}  % for inlined bib file
#+LATEX_HEADER: %\usepackage[kerning,spacing]{microtype} % more compact and arguably nicer
#+LATEX_HEADER: \usepackage[hmargin=2cm,vmargin=2.5cm]{geometry}
#+LATEX_HEADER: \usepackage{tikz}
#+LATEX_HEADER: \usepackage{listings-rust}
#+LATEX_HEADER: \usepackage{caption}
#+LATEX_HEADER: \usepackage{MnSymbol}
#+BIBLIOGRAPHY: test.bib
#+CITE_EXPORT: biblatex numeric-comp

#+begin_export latex
% Overwrite Org mode's AUTHOR for advanced usage
%\author{
%  Firstname Lastname\\\textit{Institution}
%  \and Firstname Lastname \\ \textit{AnotherInstitution}
%}
% https://tex.stackexchange.com/questions/9594/adding-more-than-one-author-with-different-affiliation
\author{
  \normalsize \textbf{Firstname Lastname} \\ \normalsize Institution \\ \small\texttt{lastname@institution.org}
  \and \normalsize \textbf{Firstname Lastname} \\ \normalsize AnotherInstitution \\ \small\texttt{another@anotherinst.org}
}

\hypersetup{
  colorlinks,
  linkcolor={green!80!black},
  citecolor={red!70!black},
  urlcolor={blue!70!black}
}

\urlstyle{same}  % fixed-width font takes too much space, so set to same, rm or sf

\colorlet{commentgreen}{teal!80!black}
\colorlet{stringred}{red!60!black}
\colorlet{keywordviolet}{violet!90!black}
% configure listings package
\lstset{
  basicstyle=\footnotesize\ttfamily,
  %identifierstyle=,
  commentstyle=\color{commentgreen},
  stringstyle=\color{stringred},
  keywordstyle=\color{keywordviolet}\bfseries,
  showstringspaces=false,
  breaklines=true,
  numbers=left,  % overwritten to none by Org Mode export
  numberstyle=\tiny,
  %stepnumber=5,
  %firstnumber=1,
  %numberfirstline=true,
  tabsize=4,
  abovecaptionskip=\medskipamount,
  belowcaptionskip=\medskipamount,
  breakatwhitespace=true,
  %prebreak=\raisebox{0ex}[0ex][0ex]{\color{gray}\ensuremath{\lcurvearrowdown}},
  prebreak=\raisebox{0ex}[0ex][0ex]{\color{gray}\ensuremath{\rhookswarrow}},
  frame=lines,
  framesep=5pt,
  tabsize=4,
  showtabs=true,
}

% space around table captions
\captionsetup[table]{skip=\medskipamount}


% Less space before title
\setlength{\droptitle}{-1cm}
% In addition to geometry options, increase column separator width
\setlength{\columnsep}{0.5cm}

% make abstract span over all columns
\twocolumn[
  \begin{@twocolumnfalse}
    %\vspace*{2cm}
    \maketitle
#+end_export

# \noindent: prevent indent at begin of abstract
# \normalsize: avoid that the abstract text is using a smaller font size than normal text
#+BEGIN_abstract
\noindent \normalsize
Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy
eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam
voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita
kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem
ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod
tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At
vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd
gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.
#+END_abstract

#+begin_export latex
    \vspace{.75cm}  % fix too small space after abstract
  \end{@twocolumnfalse}
]
#+end_export

* First section

Example for a
citation\nbsp[cite:@arpachiDusseau18:osbook;@waldspurger02;@Levis:2004:ENA:1251175.1251176]. Example
for an inline footnote[fn:: This is an inline footnote.].  This is an example
for references, to figure\nbsp[[fig:pnggraphic]], figure\nbsp[[fig:vectorgraphic]] and
figure\nbsp\ref{fig:rawlatexusingtikz}.

#+CAPTION: This is a PNG graphic.
#+NAME: fig:pnggraphic
[[./bitmap_graphic.png]]


# Vector graphics require package svg, Inkscape in PATH and pdflatex option -shell-escape
#+CAPTION: This is the caption of this graphic. It is a vector graphic.
#+NAME: fig:vectorgraphic
[[./vector_graphic.svg]]


# A raw LaTeX figure, using TikZ
#+begin_export latex
\begin{figure}
\begin{center}
\begin{tikzpicture}
  \draw[thin,gray!40] (-2,-2) grid (2,2);
  \draw[<->] (-2,0)--(2,0) node[right]{$x$};
  \draw[<->] (0,-2)--(0,2) node[above]{$y$};
  \draw[line width=2pt,blue,-stealth](0,0)--(1,1)
        node[anchor=south west]{$\boldsymbol{u}$};
  \draw[line width=2pt,red,-stealth](0,0)--(-1,-1)
        node[anchor=north east]{$\boldsymbol{-u}$};
\end{tikzpicture}
\end{center}
\caption{\label{fig:rawlatexusingtikz} This is a TikZ picture.}
\end{figure}
#+end_export

** First subsection

\lipsum[1-2]

** Second subsection

\lipsum[3]

** Third subsection

It is also possible to enter source code listings, see
listing\nbsp[[src:lispexample]] and listing\nbsp[[src:javaexamplewithnumbers]].

#+CAPTION: This is an example for an Emacs Lisp source code listing.
#+NAME: src:lispexample
#+ATTR_LATEX: :options captionpos=t
#+BEGIN_SRC emacs-lisp
  (defun org-xor (a b)
    "Exclusive or."
    (if a (not b) b))
#+END_SRC

#+CAPTION: This is an example for a Java source code listing with line numbers.
#+NAME: src:javaexamplewithnumbers
#+ATTR_LATEX: :options numbers=left,captionpos=t
#+begin_src java
/**
 * An example Java class.
 */
public class Example {
    public static void main(String[] args) {
        System.out.println("Hello, world!");
    }
}
#+end_src
# For referring to single lines, try https://tex.stackexchange.com/questions/384686/circled-references-within-code-lstlisting


#+CAPTION: This is an example for a Rust source code listing.
#+NAME: src:rustexample
#+ATTR_LATEX: :options captionpos=t
#+begin_src rust
fn main() {
    // Print text to the console. Long lines are broken. Long lines are broken.
    println!("Hello World!");
}
#+end_src



#+CAPTION: This is an example for a Make source code listing.
#+NAME: src:makeexample
#+ATTR_LATEX: :options captionpos=t
#+begin_src make
.PHONY: all
all: hello

hello: hello.c
	cc -o hello hello.c
#+end_src

* Second section

\lipsum[5]

Also tables can be exports, see table\nbsp[[tab:tabexample]].

#+CAPTION: This is a table. It contains three columns, a column header, two rows and six entries.
#+NAME: tab:tabexample
#+ATTR_LATEX: :align c|c|c
| First | Second | Third |
|-------+--------+-------|
| A     | B      | C     |
| D     | E      | F     |



#+PRINT_BIBLIOGRAPHY:
